<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'; img-src 'self' data:;">
    <title>Hexbloop Preferences</title>
    <link rel="stylesheet" href="preferences.css">
</head>
<body>
    <!-- Mystical background effects -->
    <div class="hexagon-particles">
        <div class="hex-particle hex-particle-1">‚¨°</div>
        <div class="hex-particle hex-particle-2">‚¨¢</div>
        <div class="hex-particle hex-particle-3">‚¨°</div>
        <div class="hex-particle hex-particle-4">‚¨¢</div>
        <div class="hex-particle hex-particle-5">‚¨°</div>
        <div class="hex-particle hex-particle-6">‚¨¢</div>
    </div>
    
    <div class="preferences-container">
        <!-- macOS-style tab bar -->
        <div class="tab-bar">
            <button class="tab-button active" data-tab="processing">
                <span class="tab-icon">üéöÔ∏è</span>
                <span class="tab-label">Audio</span>
            </button>
            <button class="tab-button" data-tab="naming">
                <span class="tab-icon">‚ú®</span>
                <span class="tab-label">Naming</span>
            </button>
            <button class="tab-button" data-tab="output">
                <span class="tab-icon">üìÇ</span>
                <span class="tab-label">Output</span>
            </button>
            <button class="tab-button" data-tab="artwork">
                <span class="tab-icon">üé®</span>
                <span class="tab-label">Artwork</span>
            </button>
        </div>

        <!-- Main preferences content -->
        <main class="preferences-content">
            <!-- Processing Tab -->
            <div class="tab-panel active" id="processing-tab">
            <section class="preference-section">
                <div class="section-header">
                    <h2 class="section-title">Audio Processing</h2>
                    <div class="section-description">Choose which effects to apply to your audio</div>
                </div>
                
                <div class="settings-grid">
                    <div class="setting-card">
                        <label class="setting-toggle" for="compressing">
                            <div class="setting-info">
                                <h3 id="audio-effects-label">Moon-Influenced Effects</h3>
                                <p id="audio-effects-desc">Distortion and filtering based on current lunar phase</p>
                            </div>
                            <div class="toggle-switch">
                                <input type="checkbox" 
                                       id="compressing" 
                                       data-setting="processing.compressing"
                                       aria-labelledby="audio-effects-label"
                                       aria-describedby="audio-effects-desc"
                                       role="switch">
                                <span class="slider" aria-hidden="true"></span>
                            </div>
                        </label>
                    </div>

                    <div class="setting-card">
                        <label class="setting-toggle" for="mastering">
                            <div class="setting-info">
                                <h3 id="audio-mastering-label">Professional Mastering</h3>
                                <p id="audio-mastering-desc">EQ, compression, and limiting for polished sound</p>
                            </div>
                            <div class="toggle-switch">
                                <input type="checkbox" 
                                       id="mastering" 
                                       data-setting="processing.mastering"
                                       aria-labelledby="audio-mastering-label"
                                       aria-describedby="audio-mastering-desc"
                                       role="switch">
                                <span class="slider" aria-hidden="true"></span>
                            </div>
                        </label>
                    </div>

                    <div class="setting-card">
                        <label class="setting-toggle" for="coverArt">
                            <div class="setting-info">
                                <h3 id="generate-artwork-label">Generate Artwork</h3>
                                <p id="generate-artwork-desc">Create procedural album cover artwork</p>
                            </div>
                            <div class="toggle-switch">
                                <input type="checkbox" 
                                       id="coverArt" 
                                       data-setting="processing.coverArt"
                                       aria-labelledby="generate-artwork-label"
                                       aria-describedby="generate-artwork-desc"
                                       role="switch">
                                <span class="slider" aria-hidden="true"></span>
                            </div>
                        </label>
                    </div>
                </div>
            </section>
            </div>

            <!-- Naming Tab -->
            <div class="tab-panel" id="naming-tab">
            <section class="preference-section">
                <div class="section-header">
                    <h2 class="section-title" id="file-naming-title">File Naming</h2>
                    <div class="section-description">Choose how to name your processed audio files</div>
                </div>
                
                <div class="radio-cards" role="radiogroup" aria-labelledby="file-naming-title">
                    <label class="radio-card" for="naming-mystical">
                        <input type="radio"
                               id="naming-mystical"
                               name="naming"
                               value="mystical"
                               data-setting="processing.naming"
                               aria-describedby="naming-mystical-desc">
                        <div class="radio-content">
                            <h3>Generated Names</h3>
                            <p id="naming-mystical-desc">Unique names inspired by the audio and lunar phase (e.g. CRYSTALWAVE4400)</p>
                        </div>
                        <div class="radio-indicator" aria-hidden="true"></div>
                    </label>

                    <label class="radio-card" for="naming-custom">
                        <input type="radio" 
                               id="naming-custom" 
                               name="naming" 
                               value="custom" 
                               data-setting="processing.naming"
                               aria-describedby="naming-custom-desc">
                        <div class="radio-content">
                            <h3>Custom Metadata</h3>
                            <p id="naming-custom-desc">Use your specified artist and album information below</p>
                        </div>
                        <div class="radio-indicator" aria-hidden="true"></div>
                    </label>

                    <label class="radio-card" for="naming-original">
                        <input type="radio" 
                               id="naming-original" 
                               name="naming" 
                               value="original" 
                               data-setting="processing.naming"
                               aria-describedby="naming-original-desc">
                        <div class="radio-content">
                            <h3>Original Filenames</h3>
                            <p id="naming-original-desc">Keep the original filename unchanged</p>
                        </div>
                        <div class="radio-indicator" aria-hidden="true"></div>
                    </label>
                </div>
            </section>

            <!-- Custom Metadata Section -->
            <section class="preference-section" id="custom-metadata-section">
                <div class="section-header">
                    <h2 class="section-title" id="custom-metadata-title">Custom Metadata</h2>
                    <div class="section-description">Add your artist info to the audio files</div>
                </div>
                
                <div class="metadata-form" role="group" aria-labelledby="custom-metadata-title">
                    <div class="form-row">
                        <div class="form-field">
                            <label for="custom-artist">Artist Name</label>
                            <input type="text" 
                                   id="custom-artist" 
                                   data-setting="metadata.artist" 
                                   placeholder="Your artist name"
                                   aria-label="Artist name for custom metadata"
                                   maxlength="100">
                        </div>

                        <div class="form-field">
                            <label for="custom-album">Album Title</label>
                            <input type="text" 
                                   id="custom-album" 
                                   data-setting="metadata.album" 
                                   placeholder="Your album title"
                                   aria-label="Album title for custom metadata"
                                   maxlength="100">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-field form-field-small">
                            <label for="custom-year">Year</label>
                            <input type="number" 
                                   id="custom-year" 
                                   data-setting="metadata.year" 
                                   min="1900" 
                                   max="2100" 
                                   placeholder="2025"
                                   aria-label="Release year"
                                   aria-valuemin="1900"
                                   aria-valuemax="2100">
                        </div>

                        <div class="form-field">
                            <label for="custom-genre">Genre</label>
                            <input type="text" 
                                   id="custom-genre" 
                                   data-setting="metadata.genre" 
                                   placeholder="Mystical Audio"
                                   aria-label="Music genre"
                                   maxlength="50">
                        </div>
                    </div>
                </div>
            </section>
            </div>

            <!-- Output Tab -->
            <div class="tab-panel" id="output-tab">
            <section class="preference-section">
                <div class="section-header">
                    <h2 class="section-title">Output Location</h2>
                    <div class="section-description">Choose where to save your processed files</div>
                </div>
                
                <div class="form-row">
                    <div class="form-field">
                        <label for="output-folder">Output Folder</label>
                        <div class="folder-input-group">
                            <input type="text" id="output-folder" data-setting="ui.outputFolder" readonly placeholder="~/Documents/HexbloopOutput">
                            <button type="button" id="choose-folder-btn" class="btn btn-secondary">Choose Folder</button>
                        </div>
                    </div>
                </div>
            </section>
            </div>

            <!-- Artwork Tab -->
            <div class="tab-panel" id="artwork-tab">
            <section class="preference-section">
                <div class="section-header">
                    <h2 class="section-title">Artwork Generation</h2>
                    <div class="section-description">Control how album artwork is created from your audio</div>
                </div>
                
                <div class="settings-grid">
                    <div class="setting-card">
                        <label class="setting-select" for="artwork-style">
                            <div class="setting-info">
                                <h3>Visual Style</h3>
                                <p>Default style for artwork (auto-selects based on audio if set to Auto)</p>
                            </div>
                            <select id="artwork-style" data-setting="artwork.defaultStyle">
                                <option value="auto">Auto (matches audio vibe)</option>
                                <option value="neon-plasma">Neon Plasma</option>
                                <option value="cosmic-flow">Cosmic Flow</option>
                                <option value="vapor-dream">Vapor Dream</option>
                                <option value="cyber-matrix">Cyber Matrix</option>
                                <option value="sunset-liquid">Sunset Liquid</option>
                                <option value="electric-storm">Electric Storm</option>
                                <option value="crystal-prism">Crystal Prism</option>
                                <option value="ocean-aurora">Ocean Aurora</option>
                            </select>
                        </label>
                    </div>
                </div>
                
                <div class="section-header" style="margin-top: 30px;">
                    <h3 class="section-subtitle">Audio Responsiveness</h3>
                    <div class="section-description">Fine-tune how the artwork reacts to your audio</div>
                </div>

                <div class="parameter-sliders">
                    <div class="slider-group">
                        <label for="artwork-energySensitivity">
                            <span>Energy</span>
                            <span class="slider-value" id="artwork-energySensitivity-value">50%</span>
                        </label>
                        <input type="range" id="artwork-energySensitivity" data-setting="artwork.energySensitivity"
                               min="0" max="100" step="5" value="50">
                        <p class="slider-description">How much the audio's intensity affects the visuals</p>
                    </div>

                    <div class="slider-group">
                        <label for="artwork-tempoInfluence">
                            <span>Tempo</span>
                            <span class="slider-value" id="artwork-tempoInfluence-value">50%</span>
                        </label>
                        <input type="range" id="artwork-tempoInfluence" data-setting="artwork.tempoInfluence"
                               min="0" max="100" step="5" value="50">
                        <p class="slider-description">How much the BPM influences visual movement</p>
                    </div>

                    <div class="slider-group">
                        <label for="artwork-colorVariation">
                            <span>Color Variation</span>
                            <span class="slider-value" id="artwork-colorVariation-value">50%</span>
                        </label>
                        <input type="range" id="artwork-colorVariation" data-setting="artwork.colorVariation"
                               min="0" max="100" step="5" value="50">
                        <p class="slider-description">Randomness in the color palette</p>
                    </div>
                </div>
                
                <div class="settings-grid" style="margin-top: 30px;">
                    <div class="setting-card">
                        <label class="setting-toggle" for="artwork-useAudioFeatures">
                            <div class="setting-info">
                                <h3>Audio Analysis</h3>
                                <p>Use audio features (energy, tempo) to shape the artwork</p>
                            </div>
                            <div class="toggle-switch">
                                <input type="checkbox" id="artwork-useAudioFeatures"
                                       data-setting="artwork.useAudioFeatures" checked>
                                <span class="slider"></span>
                            </div>
                        </label>
                    </div>

                    <div class="setting-card">
                        <label class="setting-toggle" for="artwork-useMoonPhase">
                            <div class="setting-info">
                                <h3>Lunar Influence</h3>
                                <p>Current moon phase affects colors and patterns</p>
                            </div>
                            <div class="toggle-switch">
                                <input type="checkbox" id="artwork-useMoonPhase"
                                       data-setting="artwork.useMoonPhase" checked>
                                <span class="slider"></span>
                            </div>
                        </label>
                    </div>

                    <div class="setting-card">
                        <label class="setting-toggle" for="artwork-useFileNames">
                            <div class="setting-info">
                                <h3>Filename Seeds</h3>
                                <p>Filename influences the artwork patterns</p>
                            </div>
                            <div class="toggle-switch">
                                <input type="checkbox" id="artwork-useFileNames"
                                       data-setting="artwork.useFileNames" checked>
                                <span class="slider"></span>
                            </div>
                        </label>
                    </div>
                </div>
                
                <div class="info-panel" style="margin-top: 30px;">
                    <h4>About Artwork Generation</h4>
                    <p><strong>8 visual styles</strong> that respond to your audio's energy and tempo</p>
                    <p><strong>1024√ó1024 resolution</strong> with procedural effects and color palettes</p>
                    <p><strong>Auto mode</strong> selects styles based on audio characteristics and filename hints</p>
                </div>
            </section>
            </div>

        </main>

        <!-- Footer with action buttons -->
        <footer class="preferences-footer">
            <div class="footer-buttons">
                <button type="button" id="reset-btn" class="btn btn-secondary">Reset to Defaults</button>
                <button type="button" id="export-btn" class="btn btn-secondary">Export Settings</button>
                <button type="button" id="import-btn" class="btn btn-secondary">Import Settings</button>
                <button type="button" id="close-btn" class="btn btn-primary">Close</button>
            </div>
        </footer>
    </div>

    <!-- Loading overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner">
            <div class="spinner-ring"></div>
            <p class="loading-text">Processing...</p>
        </div>
    </div>

    <script src="preferences.js"></script>
</body>
</html>